# 行程编码

行程(游程/游长, Run-Length), 指的是中数据连续重复出现的次数(长度). 给出行程和数据及其位置, 则可以恢复出原始数据, 该过程为行程编码([Run Length Encoding, **RLE**](https://zh.wikipedia.org/wiki/%E6%B8%B8%E7%A8%8B%E7%BC%96%E7%A0%81)), 又称为游程编码, 如: 
<u>**aaa**</u>**b**<u>**cccccc**</u>**dd**<u>**eee**</u> 
行程编码后的码组为: 
**3<u>a</u>1<u>b</u>6<u>c</u>2<u>d</u>3<u>e</u>**.

## 原理

如图所示，

<img src="https://gitee.com/yfor1008/pictures/raw/master/RLE.png" alt="RLE" style="zoom:50%;" />

行程编码的码组由码字按数据出现的顺序排列而成, 如下所示:

$$
\{(l_1, g_1), (l_2, g_2), \cdots, (l_k, g_k)\} \tag{公式1}
$$

码字 $(l_i, g_i)$ 由长度 $l_i$ (原始数据中连续相同数据的个数)和 数据 $g_i$ 构成. 编码后的码组需满足如下要求才能恢复出原始数据:

-  $g_i$ 的顺序需与数据顺序相同
-  数据的长度=所有行程之和, 即: $length = \sum_{i=1}^{k}l_i$ , `k` 为数据中前后数据不相同的个数, 即行程个数.


## JPEG实现

针对JPEG实现的特性, 行程编码也进行了相应调整, 主要调整有2个方面:
- 统计非0数据前面0的个数, 构成码字: **(0的个数, 非0数据)**
- 为方便编码, JPEG中使用16个bits来编码**0的个数**, 因而**0的个数**不会超过15, 若0连续出现的次数超过16, 则将其截断, 连续16个, 编码为: **(15, 0)**

