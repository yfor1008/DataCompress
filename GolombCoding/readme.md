# Golomb 编码

Golomb 编码([Golomb Coding](https://en.wikipedia.org/wiki/Golomb_coding))对非负整数进行编码, 适合对几何分布的数据(小数字出现的概率高, 大数字出现的概率低)进行编码.

**基本原理**

Golomb编码是一种分组编码, 对分组index和组内index进行编码, 如下图所示, 以`m`为分组长度对待编码数据进行分组.

![golomb_group](https://gitee.com/yfor1008/pictures/raw/master/golomb_group.png)

其基本原理为: 对于任一非负整数`N`, 利用参数`m`对其分组, 将其分为商`q`(`q=N//m`, 分组的index)和余数`r`(`r=N%m`, 分组内部的index), 对`q`使用一元码编码, 对`r`使用截断二进制编码:

**编码示例**

n|0|1|2|3|4|5|6|7|8|9|10 
:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-: 
m=3|0\|0|0\|10|0\|11|10\|0|10\|10|10\|11|110\|0|110\|10|110\|11|1110\|0|1110\|10 
m=4|0\|00|0\|01|0\|10|0\|11|10\|00|10\|01|10\|10|10\|11|110\|00|110\|01|110\|10 
m=5|0\|00|0\|01|0\|10|0\|110|0\|111|10\|00|10\|01|10\|10|10\|110|10\|111|110\|00 
m=8|0\|000|0\|001|0\|010|0\|011|0\|100|0\|101|0\|110|0\|111|10\|000|10\|001|10\|010 

# Golomb-Rice 编码

将参数`m`设置为2的幂次就是**Golomb-Rice 编码**, 这样做的好处是:
1. 计算余数`r`比较方便, `r=N&(m-1)`, 这里是按位与
2. 对余数`r`编解码简单

# Exp-Golomb 编码

指数哥伦布编码([Exponential-Golomb Coding, Exp-Golomb](https://en.wikipedia.org/wiki/Exponential-Golomb_coding))是一种改进, 使其更加符合几何分布, 不再使用固定的分组大小, 而是呈指数增长的, 如下图所示:

![golomb_exp_group](https://gitee.com/yfor1008/pictures/raw/master/golomb_exp_group-16380162869531.png)

**基本原理**

对于任一非负整数`N`, 其组号(分组index)为`m=floor(log2(N+1))`, 组内偏移量(组内index)为`offset=N+1-2^m`, 对`m`进行一元码编码, 对`offset`使用长度为`m`个bit的二进制进行编码.

**将`offset=N+1-2^m`更改为`offset=N-(2^m-1)`会更容易理解一些, 数据`N`所在分组为`m`, 前面所有分组的数据的个数和为`2^m-1`, 因而当前分组内的偏移量为`N-(2^m-1)`.**

这里`m`的取值为: 0, 1, 2, ..., 因而其对应的分组内可以编码的数据的个数为: 1(2^0), 2(2^1), 4(2^2), ...

为了更具一般性, 使用参数`k`进行了推广, 对分组`m`使用`m+k`个bit进行编码: 对于任一非负整数`N`, 其组号(分组index)为`m=floor(log2(N/(2^k)+1))`, 组内偏移量(组内index)为`offset=N-(2^m-1)*2^k`, 对`m`进行一元码编码, 对`offset`使用长度为`m`个bit的二进制进行编码.

对于不同的`k`, 组内编码数据个数分别为:
- `k=0`, 1(2^0), 2(2^1), 4(2^2), ...
- `k=1`, 2(2^1), 4(2^3), 8(2^3), ...
- `k=2`, 4(2^2), 8(2^3), 16(2^4), ...
- `k=3`, 8(2^3), 16(2^4), 32(2^5), ...

**编码示例**

 x | k=0 | k=1 | k=2 | k=3 
 :-: | :-: | :-: | :-: | :-: 
 0|1\||1\|0|1\|00|1\|000 
 1|01\|0|1\|1|1\|01|1\|001 
 2|01\|1|01\|00|1\|10|1\|010 
 3|001\|00|01\|01|1\|11|1\|011 
 4|001\|01|01\|10|01\|000|1\|100 
 5|001\|10|01\|11|01\|001|1\|101 
 6|001\|11|001\|000|01\|010|1\|110 
 7|0001\|000|001\|001|01\|011|1\|111 
 8|0001\|001|001\|010|01\|100|01\|0000 
 9|0001\|010|001\|011|01\|101|01\|0001 
 10|0001\|011|001\|100|01\|110|01\|0010 
 11|0001\|100|001\|101|01\|111|01\|0011 
 12|0001\|101|001\|110|001\|0000|01\|0100 
 13|0001\|110|001\|111|001\|0001|01\|0101 
 14|0001\|111|0001\|0000|001\|0010|01\|0110 
 15|00001\|0000|0001\|0001|001\|0011|01\|0111 
 16|00001\|0001|0001\|0010|001\|0100|01\|1000 
 17|00001\|0010|0001\|0011|001\|0101|01\|1001 
 18|00001\|0011|0001\|0100|001\|0110|01\|1010 
 19|00001\|0100|0001\|0101|001\|0111|01\|1011 
 20|00001\|0101|0001\|0110|001\|1000|01\|1100 
 21|00001\|0110|0001\|0111|001\|1001|01\|1101 
 22|00001\|0111|0001\|1000|001\|1010|01\|1110 
 23|00001\|1000|0001\|1001|001\|1011|01\|1111 
 24|00001\|1001|0001\|1010|001\|1100|001\|00000 
 25|00001\|1010|0001\|1011|001\|1101|001\|00001 
 26|00001\|1011|0001\|1100|001\|1110|001\|00010 
 27|00001\|1100|0001\|1101|001\|1111|001\|00011 
 28|00001\|1101|0001\|1110|0001\|00000|001\|00100 
 29|00001\|1110|0001\|1111|0001\|00001|001\|00101 



参考:

1. [哥伦布（Golomb）压缩编码](https://www.pynote.net/archives/3020)
2. [Data Compression学习笔记一：Golomb编码](https://zhuanlan.zhihu.com/p/180520059)
3. [Golomb及指数哥伦布编码原理介绍及实现](https://www.cnblogs.com/wangguchangqing/p/6297792.html)
4. [Exponential-Golomb Coding](https://en.wikipedia.org/wiki/Exponential-Golomb_coding)

